{"ast":null,"code":"import _objectSpread from\"/home/adreen/Development/code/phase-4/gym-management-system/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import{useState,useEffect,useCallback}from'react';import{Toaster,toast}from'react-hot-toast';import{useNavigate}from'react-router-dom';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function TrainerDashboard(){const[dashboardData,setDashboardData]=useState(null);const[loading,setLoading]=useState(true);const[newClass,setNewClass]=useState({name:'',date_time:'',max_capacity:10});const navigate=useNavigate();// ✅ Wrap fetchDashboard in useCallback\nconst fetchDashboard=useCallback(async()=>{try{const response=await fetch('http://localhost:5000/api/trainer-dashboard',{headers:{Authorization:\"Bearer \".concat(localStorage.getItem('token'))}});const data=await response.json();if(response.ok){setDashboardData(data);}else{toast.error(data.error||'Failed to load dashboard');if(response.status===401){localStorage.removeItem('token');localStorage.removeItem('role');navigate('/login');}}}catch(error){toast.error('Network error!');console.error('Fetch error:',error);}finally{setLoading(false);}},[navigate]);// ✅ Use fetchDashboard in useEffect dependency array\nuseEffect(()=>{fetchDashboard();},[fetchDashboard]);const handleClassSubmit=async e=>{e.preventDefault();try{const response=await fetch('http://localhost:5000/api/classes',{method:'POST',headers:{'Content-Type':'application/json',Authorization:\"Bearer \".concat(localStorage.getItem('token'))},body:JSON.stringify(newClass)});const data=await response.json();if(response.ok){toast.success('Class created!');setNewClass({name:'',date_time:'',max_capacity:10});fetchDashboard();}else{toast.error(data.error||'Failed to create class');}}catch(error){toast.error('Network error!');console.error('Fetch error:',error);}};if(loading){return/*#__PURE__*/_jsx(\"div\",{className:\"min-h-screen bg-gray-100 flex items-center justify-center\",children:/*#__PURE__*/_jsx(\"p\",{className:\"text-lg font-semibold\",children:\"Loading...\"})});}if(!dashboardData){return/*#__PURE__*/_jsx(\"div\",{className:\"min-h-screen bg-gray-100 flex items-center justify-center\",children:/*#__PURE__*/_jsx(\"p\",{className:\"text-lg text-red-500\",children:\"Failed to load dashboard data\"})});}return/*#__PURE__*/_jsxs(\"div\",{className:\"min-h-screen bg-gray-100 p-6\",children:[/*#__PURE__*/_jsxs(\"h1\",{className:\"text-3xl font-bold text-gymBlue mb-6\",children:[\"Welcome, \",dashboardData.user.username,\" (Trainer)\"]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white p-6 rounded-lg shadow-xl mb-6\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-xl font-semibold mb-4\",children:\"Create Class\"}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleClassSubmit,className:\"space-y-4\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:newClass.name,onChange:e=>setNewClass(_objectSpread(_objectSpread({},newClass),{},{name:e.target.value})),placeholder:\"Class Name\",className:\"w-full p-2 border rounded\",required:true}),/*#__PURE__*/_jsx(\"input\",{type:\"datetime-local\",value:newClass.date_time,onChange:e=>setNewClass(_objectSpread(_objectSpread({},newClass),{},{date_time:e.target.value})),className:\"w-full p-2 border rounded\",required:true}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",value:newClass.max_capacity,onChange:e=>setNewClass(_objectSpread(_objectSpread({},newClass),{},{max_capacity:e.target.value})),placeholder:\"Max Capacity\",className:\"w-full p-2 border rounded\",min:\"1\"}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"w-full bg-gymGreen text-white p-2 rounded hover:bg-green-700\",children:\"Create Class\"})]}),/*#__PURE__*/_jsx(\"h2\",{className:\"text-xl font-semibold mt-6 mb-4\",children:\"Trained Users\"}),/*#__PURE__*/_jsx(\"div\",{className:\"space-y-2\",children:dashboardData.trained_users.length>0?dashboardData.trained_users.map(user=>/*#__PURE__*/_jsx(\"div\",{className:\"p-2 border rounded\",children:user.username},user.id)):/*#__PURE__*/_jsx(\"p\",{children:\"No trainees assigned.\"})}),/*#__PURE__*/_jsx(\"h2\",{className:\"text-xl font-semibold mt-6 mb-4\",children:\"Class Stats\"}),/*#__PURE__*/_jsx(\"div\",{className:\"space-y-2\",children:dashboardData.class_stats.length>0?dashboardData.class_stats.map(stat=>/*#__PURE__*/_jsxs(\"div\",{className:\"p-2 border rounded\",children:[stat.name,\": \",stat.attendance_count,\" attendees\"]},stat.name)):/*#__PURE__*/_jsx(\"p\",{children:\"No classes created.\"})})]}),/*#__PURE__*/_jsx(Toaster,{position:\"top-right\"})]});}export default TrainerDashboard;","map":{"version":3,"names":["useState","useEffect","useCallback","Toaster","toast","useNavigate","jsx","_jsx","jsxs","_jsxs","TrainerDashboard","dashboardData","setDashboardData","loading","setLoading","newClass","setNewClass","name","date_time","max_capacity","navigate","fetchDashboard","response","fetch","headers","Authorization","concat","localStorage","getItem","data","json","ok","error","status","removeItem","console","handleClassSubmit","e","preventDefault","method","body","JSON","stringify","success","className","children","user","username","onSubmit","type","value","onChange","_objectSpread","target","placeholder","required","min","trained_users","length","map","id","class_stats","stat","attendance_count","position"],"sources":["/home/adreen/Development/code/phase-4/gym-management-system/frontend/src/pages/TrainerDashboard.js"],"sourcesContent":["import { useState, useEffect, useCallback } from 'react';\nimport { Toaster, toast } from 'react-hot-toast';\nimport { useNavigate } from 'react-router-dom';\n\nfunction TrainerDashboard() {\n  const [dashboardData, setDashboardData] = useState(null);\n  const [loading, setLoading] = useState(true);\n  const [newClass, setNewClass] = useState({ name: '', date_time: '', max_capacity: 10 });\n  const navigate = useNavigate();\n\n  // ✅ Wrap fetchDashboard in useCallback\n  const fetchDashboard = useCallback(async () => {\n    try {\n      const response = await fetch('http://localhost:5000/api/trainer-dashboard', {\n        headers: { Authorization: `Bearer ${localStorage.getItem('token')}` },\n      });\n      const data = await response.json();\n      if (response.ok) {\n        setDashboardData(data);\n      } else {\n        toast.error(data.error || 'Failed to load dashboard');\n        if (response.status === 401) {\n          localStorage.removeItem('token');\n          localStorage.removeItem('role');\n          navigate('/login');\n        }\n      }\n    } catch (error) {\n      toast.error('Network error!');\n      console.error('Fetch error:', error);\n    } finally {\n      setLoading(false);\n    }\n  }, [navigate]);\n\n  // ✅ Use fetchDashboard in useEffect dependency array\n  useEffect(() => {\n    fetchDashboard();\n  }, [fetchDashboard]);\n\n  const handleClassSubmit = async (e) => {\n    e.preventDefault();\n    try {\n      const response = await fetch('http://localhost:5000/api/classes', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json', Authorization: `Bearer ${localStorage.getItem('token')}` },\n        body: JSON.stringify(newClass),\n      });\n      const data = await response.json();\n      if (response.ok) {\n        toast.success('Class created!');\n        setNewClass({ name: '', date_time: '', max_capacity: 10 });\n        fetchDashboard();\n      } else {\n        toast.error(data.error || 'Failed to create class');\n      }\n    } catch (error) {\n      toast.error('Network error!');\n      console.error('Fetch error:', error);\n    }\n  };\n\n  if (loading) {\n    return (\n      <div className=\"min-h-screen bg-gray-100 flex items-center justify-center\">\n        <p className=\"text-lg font-semibold\">Loading...</p>\n      </div>\n    );\n  }\n\n  if (!dashboardData) {\n    return (\n      <div className=\"min-h-screen bg-gray-100 flex items-center justify-center\">\n        <p className=\"text-lg text-red-500\">Failed to load dashboard data</p>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen bg-gray-100 p-6\">\n      <h1 className=\"text-3xl font-bold text-gymBlue mb-6\">\n        Welcome, {dashboardData.user.username} (Trainer)\n      </h1>\n      <div className=\"bg-white p-6 rounded-lg shadow-xl mb-6\">\n        <h2 className=\"text-xl font-semibold mb-4\">Create Class</h2>\n        <form onSubmit={handleClassSubmit} className=\"space-y-4\">\n          <input\n            type=\"text\"\n            value={newClass.name}\n            onChange={(e) => setNewClass({ ...newClass, name: e.target.value })}\n            placeholder=\"Class Name\"\n            className=\"w-full p-2 border rounded\"\n            required\n          />\n          <input\n            type=\"datetime-local\"\n            value={newClass.date_time}\n            onChange={(e) => setNewClass({ ...newClass, date_time: e.target.value })}\n            className=\"w-full p-2 border rounded\"\n            required\n          />\n          <input\n            type=\"number\"\n            value={newClass.max_capacity}\n            onChange={(e) => setNewClass({ ...newClass, max_capacity: e.target.value })}\n            placeholder=\"Max Capacity\"\n            className=\"w-full p-2 border rounded\"\n            min=\"1\"\n          />\n          <button type=\"submit\" className=\"w-full bg-gymGreen text-white p-2 rounded hover:bg-green-700\">\n            Create Class\n          </button>\n        </form>\n\n        <h2 className=\"text-xl font-semibold mt-6 mb-4\">Trained Users</h2>\n        <div className=\"space-y-2\">\n          {dashboardData.trained_users.length > 0 ? (\n            dashboardData.trained_users.map((user) => (\n              <div key={user.id} className=\"p-2 border rounded\">\n                {user.username}\n              </div>\n            ))\n          ) : (\n            <p>No trainees assigned.</p>\n          )}\n        </div>\n\n        <h2 className=\"text-xl font-semibold mt-6 mb-4\">Class Stats</h2>\n        <div className=\"space-y-2\">\n          {dashboardData.class_stats.length > 0 ? (\n            dashboardData.class_stats.map((stat) => (\n              <div key={stat.name} className=\"p-2 border rounded\">\n                {stat.name}: {stat.attendance_count} attendees\n              </div>\n            ))\n          ) : (\n            <p>No classes created.</p>\n          )}\n        </div>\n      </div>\n      <Toaster position=\"top-right\" />\n    </div>\n  );\n}\n\nexport default TrainerDashboard;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}