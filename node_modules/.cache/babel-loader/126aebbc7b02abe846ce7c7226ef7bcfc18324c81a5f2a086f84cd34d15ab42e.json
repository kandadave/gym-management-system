{"ast":null,"code":"import _objectSpread from\"/home/adreen/Development/code/phase-4/gym-management-system/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import{useState,useEffect}from'react';import{Toaster,toast}from'react-hot-toast';import{useNavigate}from'react-router-dom';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function ClassRSVP(){const[classes,setClasses]=useState([]);const[loading,setLoading]=useState(true);const navigate=useNavigate();useEffect(()=>{const fetchClasses=async()=>{try{const response=await fetch('http://localhost:5000/api/classes',{headers:{Authorization:\"Bearer \".concat(localStorage.getItem('token'))}});const data=await response.json();if(response.ok){// Initialize RSVP status for each class based on backend data\nsetClasses(data.map(cls=>_objectSpread(_objectSpread({},cls),{},{rsvped:false})));}else{toast.error(data.error||'Failed to fetch classes');if(response.status===401){localStorage.removeItem('token');localStorage.removeItem('role');navigate('/login');}}}catch(error){toast.error('Network error!');console.error('Fetch error:',error);}finally{setLoading(false);}};fetchClasses();},[navigate]);const handleRSVP=async classId=>{try{const response=await fetch('http://localhost:5000/api/rsvp',{method:'POST',headers:{'Content-Type':'application/json',Authorization:\"Bearer \".concat(localStorage.getItem('token'))},body:JSON.stringify({class_id:classId})});const data=await response.json();if(response.ok){toast.success('RSVP successful!');setClasses(classes.map(cls=>cls.id===classId?_objectSpread(_objectSpread({},cls),{},{rsvped:true,current_capacity:cls.current_capacity+1}):cls));}else{toast.error(data.error||'Failed to RSVP');}}catch(error){toast.error('Network error!');console.error('Fetch error:',error);}};if(loading){return/*#__PURE__*/_jsx(\"div\",{className:\"min-h-screen bg-gray-100 flex items-center justify-center\",children:/*#__PURE__*/_jsx(\"p\",{className:\"text-lg font-semibold text-gymBlue\",children:\"Loading classes...\"})});}return/*#__PURE__*/_jsxs(\"div\",{className:\"min-h-screen bg-gray-100 p-6\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-3xl font-bold text-gymBlue mb-6\",children:\"Class RSVP\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white p-6 rounded-lg shadow-xl max-w-2xl mx-auto\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-xl font-semibold text-gymBlue mb-4\",children:\"Available Classes\"}),classes.length===0?/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600\",children:\"No classes available at the moment.\"}):/*#__PURE__*/_jsx(\"ul\",{className:\"space-y-4\",children:classes.map(cls=>/*#__PURE__*/_jsxs(\"li\",{className:\"border-b pb-4 flex justify-between items-center\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"font-semibold text-lg\",children:cls.name}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-gray-600\",children:[\"Date/Time: \",new Date(cls.date_time).toLocaleString()]}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-gray-600\",children:[\"Description: \",cls.description||'No description provided']}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-gray-600\",children:[\"Capacity: \",cls.current_capacity,\"/\",cls.max_capacity]})]}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleRSVP(cls.id),disabled:cls.rsvped||cls.current_capacity>=cls.max_capacity,className:\"px-4 py-2 rounded transition font-semibold\\n                    \".concat(cls.rsvped||cls.current_capacity>=cls.max_capacity?'bg-gray-400 text-white cursor-not-allowed':'bg-gymGreen text-white hover:bg-green-700'),children:cls.rsvped?'RSVPed':cls.current_capacity>=cls.max_capacity?'Full':'RSVP'})]},cls.id))})]}),/*#__PURE__*/_jsx(Toaster,{position:\"top-right\"})]});}export default ClassRSVP;","map":{"version":3,"names":["useState","useEffect","Toaster","toast","useNavigate","jsx","_jsx","jsxs","_jsxs","ClassRSVP","classes","setClasses","loading","setLoading","navigate","fetchClasses","response","fetch","headers","Authorization","concat","localStorage","getItem","data","json","ok","map","cls","_objectSpread","rsvped","error","status","removeItem","console","handleRSVP","classId","method","body","JSON","stringify","class_id","success","id","current_capacity","className","children","length","name","Date","date_time","toLocaleString","description","max_capacity","onClick","disabled","position"],"sources":["/home/adreen/Development/code/phase-4/gym-management-system/frontend/src/pages/ClassRSVP.js"],"sourcesContent":["import { useState, useEffect } from 'react';\nimport { Toaster, toast } from 'react-hot-toast';\nimport { useNavigate } from 'react-router-dom';\n\nfunction ClassRSVP() {\n  const [classes, setClasses] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const navigate = useNavigate();\n\n  useEffect(() => {\n    const fetchClasses = async () => {\n      try {\n        const response = await fetch('http://localhost:5000/api/classes', {\n          headers: { Authorization: `Bearer ${localStorage.getItem('token')}` },\n        });\n        const data = await response.json();\n        if (response.ok) {\n          // Initialize RSVP status for each class based on backend data\n          setClasses(data.map(cls => ({ ...cls, rsvped: false })));\n        } else {\n          toast.error(data.error || 'Failed to fetch classes');\n          if (response.status === 401) {\n            localStorage.removeItem('token');\n            localStorage.removeItem('role');\n            navigate('/login');\n          }\n        }\n      } catch (error) {\n        toast.error('Network error!');\n        console.error('Fetch error:', error);\n      } finally {\n        setLoading(false);\n      }\n    };\n\n    fetchClasses();\n  }, [navigate]);\n\n  const handleRSVP = async (classId) => {\n    try {\n      const response = await fetch('http://localhost:5000/api/rsvp', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          Authorization: `Bearer ${localStorage.getItem('token')}`,\n        },\n        body: JSON.stringify({ class_id: classId }),\n      });\n      const data = await response.json();\n      if (response.ok) {\n        toast.success('RSVP successful!');\n        setClasses(classes.map(cls =>\n          cls.id === classId ? { ...cls, rsvped: true, current_capacity: cls.current_capacity + 1 } : cls\n        ));\n      } else {\n        toast.error(data.error || 'Failed to RSVP');\n      }\n    } catch (error) {\n      toast.error('Network error!');\n      console.error('Fetch error:', error);\n    }\n  };\n\n  if (loading) {\n    return (\n      <div className=\"min-h-screen bg-gray-100 flex items-center justify-center\">\n        <p className=\"text-lg font-semibold text-gymBlue\">Loading classes...</p>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen bg-gray-100 p-6\">\n      <h1 className=\"text-3xl font-bold text-gymBlue mb-6\">Class RSVP</h1>\n      <div className=\"bg-white p-6 rounded-lg shadow-xl max-w-2xl mx-auto\">\n        <h2 className=\"text-xl font-semibold text-gymBlue mb-4\">Available Classes</h2>\n        {classes.length === 0 ? (\n          <p className=\"text-gray-600\">No classes available at the moment.</p>\n        ) : (\n          <ul className=\"space-y-4\">\n            {classes.map((cls) => (\n              <li\n                key={cls.id}\n                className=\"border-b pb-4 flex justify-between items-center\"\n              >\n                <div>\n                  <p className=\"font-semibold text-lg\">{cls.name}</p>\n                  <p className=\"text-gray-600\">Date/Time: {new Date(cls.date_time).toLocaleString()}</p>\n                  <p className=\"text-gray-600\">Description: {cls.description || 'No description provided'}</p>\n                  <p className=\"text-gray-600\">\n                    Capacity: {cls.current_capacity}/{cls.max_capacity}\n                  </p>\n                </div>\n                <button\n                  onClick={() => handleRSVP(cls.id)}\n                  disabled={cls.rsvped || cls.current_capacity >= cls.max_capacity}\n                  className={`px-4 py-2 rounded transition font-semibold\n                    ${cls.rsvped || cls.current_capacity >= cls.max_capacity\n                      ? 'bg-gray-400 text-white cursor-not-allowed'\n                      : 'bg-gymGreen text-white hover:bg-green-700'\n                    }`}\n                >\n                  {cls.rsvped ? 'RSVPed' : cls.current_capacity >= cls.max_capacity ? 'Full' : 'RSVP'}\n                </button>\n              </li>\n            ))}\n          </ul>\n        )}\n      </div>\n      <Toaster position=\"top-right\" />\n    </div>\n  );\n}\n\nexport default ClassRSVP;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}